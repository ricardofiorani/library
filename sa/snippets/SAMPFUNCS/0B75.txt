{$CLEO}
{$USE SAMPFUNCS}

int prefix = allocate_memory {size} 255
int msg = allocate_memory {size} 255

while true
    wait {time} 0
    
    int color
    if
        samp_get_chat_line {index} 99 {messageBuffer} msg {prefixBuffer} prefix {messageColor} color {prefixColor} -1 // get most recent message
    then
        print_formatted_now {format} "Color: %p~n~Prefix: %s~n~Message: %s" {time} 100 {args} color prefix msg
    else
        print_formatted_now {format} "Line not found" {time} 100
    end
end